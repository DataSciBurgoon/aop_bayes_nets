install.packages("gRain")
library(gRain)
install.packages("gRbase")
library(gRain)
install.packages("RBGL")
source("https://bioconductor.org/biocLite.R")
biocLite("RBGL")
library(gRain)
?cptable
yn   <- c("yes","no")
ynm  <- c("yes","no","maybe")
a    <- cptable( ~ asia, values=c(1,99), levels=yn)
a
t.a  <- cptable( ~ tub : asia, values=c(5,95,1,99,1,999),  levels=ynm)
t.a
bayes.levels  <- c('Enzyme', 'Keratine', 'unknown')
root.node     <- cptable( ~R, values=c( 1, 1, 1 ), levels=bayes.levels)
root.node
cond.prob.tbl <- t(matrix( c( 1, 0, 0, 0, 1, 0, 0.5, 0.5, 0 ),
nrow=3, ncol=3, byrow=TRUE, dimnames=list(bayes.levels, bayes.levels)))
cond.prob.tbl
yn <- c("yes", "no")
nrf2 <- cptable(~chem_activates_nrf2, values=c(0.5, 0.5), levels=yn)
nrf2
t.a
a
t.a
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95))
fxr
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fxr
root.node
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
plist <- compileCPT(list(nrf2, fxr))
plist
plot(plist)
bn_test <- grain(plist)
plot(bn_test)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
ppar_alpha
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.50, 0.95, 0.05, 0.50, 0.50, 0.50, 0.50,
0.50, 0.50, 0.50, 0.50, 0.05, 0.95, 0.50, 0.50),
levels=yn)
ppar_alpha
fxr
cond.prob.tbl
root.node
d.a
t.a
a
root.node
cond.prob.tbl
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha))
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.50, 0.95, 0.05, 0.50, 0.50, 0.50, 0.50,
0.50, 0.50, 0.50, 0.50, 0.05, 0.95, 0.50, 0.50),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha))
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha))
bn_test <- grain(plist)
plot(bn_test)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
fxr
shp
querygrain(setEvidence(bn_test, evidence=list(nrf2="no")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes", shp="yes")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes", shp="yes", lxr="no")) )
querygrain(setEvidence(bn_test, evidence=list(fxr="yes", shp="yes", lxr="no")) )
querygrain(setEvidence(bn_test, evidence=list(fxr="yes", shp="yes", lxr="yes")) )
querygrain(setEvidence(bn_test, evidence=list(fxr="yes", shp="yes", lxr="no")) )
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(fxr="yes", shp="yes", lxr="no")) )
querygrain(setEvidence(bn_test, evidence=list(fxr="yes", shp="yes", lxr="yes")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes", lxr="yes")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4))
bn_test <- grain(plist)
plot(bn_test)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~fatty_acid_beta_oxidation, values=c(round(prior_er_pos,2), 1-round(prior_er_pos,2)),levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4, fatty_acid_beta_oxidation, steatosis))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
plot(bn_test)
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(1, 0, 0, 1), levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4, fatty_acid_beta_oxidation, steatosis))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(1, 0, 0, 1), levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4, fatty_acid_beta_oxidation, steatosis))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0, 1, 1, 0), levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4, fatty_acid_beta_oxidation, steatosis))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0, 1, 1, 0), levels=yn)
lrh1 <- cptable(~lrh1 | shp,
values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
fas <- cptable(~fas | lrh1+lxr, values=c(0.95, 0.75, 0.75, 0.05,
0.05, 0.25, 0.25, 0.95),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4,
fatty_acid_beta_oxidation, steatosis, lrh1, fas))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0, 1, 1, 0), levels=yn)
lrh1 <- cptable(~lrh1 | shp,
values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
pi3k <- cptable(~pi3k, values=c(0.50, 0.50), levels=yn)
mtorc2 <- cptable(~mtorc2 | ir, values=c(1, 0, 0, 1), levels=yn)
ir <- cptable(~ir, values=c(0.50, 0.50), levels=yn)
akt <- cptable(~akt | pi3k+mtorc2, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
lfabp <- cptable(~lfabp | akt+pi3k, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
pparg <- cptable(~pparg | lfabp, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fas <- cptable(~fas | lrh1+lxr+pparg, values=c(0.95, 0.75, 0.75, 0.50, 0.75, 0.50, 0.50, 0.05,
0.05, 0.25, 0.25, 0.50, 0.25, 0.50, 0.50, 0.95),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4,
fatty_acid_beta_oxidation, steatosis, lrh1, pi3k,
mtorc2, ir, akt, lfabp, pparg, fas))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
plot(bn_test)
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0, 1, 1, 0), levels=yn)
lrh1 <- cptable(~lrh1 | shp,
values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
pi3k <- cptable(~pi3k, values=c(0.50, 0.50), levels=yn)
mtorc2 <- cptable(~mtorc2 | ir, values=c(1, 0, 0, 1), levels=yn)
ir <- cptable(~ir, values=c(0.50, 0.50), levels=yn)
akt <- cptable(~akt | pi3k+mtorc2, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
lfabp <- cptable(~lfabp | akt+pi3k, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
pparg <- cptable(~pparg | lfabp, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fas <- cptable(~fas | lrh1+lxr+pparg, values=c(0.95, 0.75, 0.75, 0.50, 0.75, 0.50, 0.50, 0.05,
0.05, 0.25, 0.25, 0.50, 0.25, 0.50, 0.50, 0.95),
levels=yn)
mtorc1 <- cptable(~mtorc1 | akt, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
apkc <- cptable(~apkc | pi3k, values=c(1, 0, 0, 1), levels=yn)
srebp1 <- cptable(~srebp1 | mtorc1 + apkc, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels-yn)
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0, 1, 1, 0), levels=yn)
lrh1 <- cptable(~lrh1 | shp,
values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
pi3k <- cptable(~pi3k, values=c(0.50, 0.50), levels=yn)
mtorc2 <- cptable(~mtorc2 | ir, values=c(1, 0, 0, 1), levels=yn)
ir <- cptable(~ir, values=c(0.50, 0.50), levels=yn)
akt <- cptable(~akt | pi3k+mtorc2, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
lfabp <- cptable(~lfabp | akt+pi3k, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
pparg <- cptable(~pparg | lfabp, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fas <- cptable(~fas | lrh1+lxr+pparg, values=c(0.95, 0.75, 0.75, 0.50, 0.75, 0.50, 0.50, 0.05,
0.05, 0.25, 0.25, 0.50, 0.25, 0.50, 0.50, 0.95),
levels=yn)
mtorc1 <- cptable(~mtorc1 | akt, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
apkc <- cptable(~apkc | pi3k, values=c(1, 0, 0, 1), levels=yn)
srebp1 <- cptable(~srebp1 | mtorc1 + apkc, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
scd1 <- cptable(~scd1 | srebp1, values=c(1, 0, 0, 1), levels=yn)
lipogenesis <- cptable(~lipogenesis | scd1 + fas, values=c(0.95, 0.95, 0.66, 0,
0.05, 0.05, 0.33, 1),
levels=yn)
cytosolic_fatty_acids <- cptable(~cytosolic_fatty_acids | lipogenesis + lfabp + fatty_acid_beta_oxidation,
values=c(0.01, 1, 0.01, 0.95, 0.01, 0.66, 0.01, 0.50,
0.99, 0, 0.99, 0.05, 0.99, 0.34, 0.99, 0.50),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4,
fatty_acid_beta_oxidation, steatosis, lrh1, pi3k,
mtorc2, ir, akt, lfabp, pparg, fas, mtorc1, apkc, srebp1, scd1, lipogenesis,
cytosolic_fatty_acids))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no")) )
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no", nrf2="yes")) )
library(gRain)
#Building the Bayes Net
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.95, 0.50, 0.50, 0.50, 0.50, 0.05, 0.50,
0.50, 0.05, 0.50, 0.50, 0.50, 0.50, 0.95, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(1, 0, 0, 1), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0, 1, 1, 0), levels=yn)
lrh1 <- cptable(~lrh1 | shp,
values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
pi3k <- cptable(~pi3k, values=c(0.50, 0.50), levels=yn)
mtorc2 <- cptable(~mtorc2 | ir, values=c(1, 0, 0, 1), levels=yn)
ir <- cptable(~ir, values=c(0.50, 0.50), levels=yn)
akt <- cptable(~akt | pi3k+mtorc2, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
lfabp <- cptable(~lfabp | akt+pi3k, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
pparg <- cptable(~pparg | lfabp, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fas <- cptable(~fas | lrh1+lxr+pparg, values=c(0.95, 0.75, 0.75, 0.50, 0.75, 0.50, 0.50, 0.05,
0.05, 0.25, 0.25, 0.50, 0.25, 0.50, 0.50, 0.95),
levels=yn)
mtorc1 <- cptable(~mtorc1 | akt, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
apkc <- cptable(~apkc | pi3k, values=c(1, 0, 0, 1), levels=yn)
srebp1 <- cptable(~srebp1 | mtorc1 + apkc, values=c(0.95, 0.95, 0.95, 0.05,
0.05, 0.05, 0.05, 0.95),
levels=yn)
scd1 <- cptable(~scd1 | srebp1, values=c(1, 0, 0, 1), levels=yn)
lipogenesis <- cptable(~lipogenesis | scd1 + fas, values=c(0.95, 0.95, 0.66, 0,
0.05, 0.05, 0.33, 1),
levels=yn)
cytosolic_fatty_acids <- cptable(~cytosolic_fatty_acids | lipogenesis + lfabp + fatty_acid_beta_oxidation,
values=c(0.01, 1, 0.01, 0.95, 0.01, 0.66, 0.01, 0.50,
0.99, 0, 0.99, 0.05, 0.99, 0.34, 0.99, 0.50),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4,
fatty_acid_beta_oxidation, steatosis, lrh1, pi3k,
mtorc2, ir, akt, lfabp, pparg, fas, mtorc1, apkc, srebp1, scd1, lipogenesis,
cytosolic_fatty_acids))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no")) )
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="yes")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="no")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="no")) )
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no")) )
library(gRain)
#Building the Bayes Net
yn <- c("yes", "no")
nrf2 <- cptable(~ nrf2, values=c(0.5, 0.5), levels=yn)
fxr <- cptable(~ fxr | nrf2, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
shp <- cptable(~ shp | fxr, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
lxr <- cptable(~ lxr | shp, values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
ppar_alpha <- cptable(~ ppara | fxr+shp+lxr,
values=c(0.50, 0.50, 0.50, 0.50, 0.50, 0.50,
0.01, 0.99, 0.99, 0.01, 0.50, 0.50),
levels=yn)
hsd17b4 <- cptable(~ hsd17b4 | ppara, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fatty_acid_beta_oxidation <- cptable(~ fatty_acid_beta_oxidation | hsd17b4,
values = c(0.99, 0.01, 0.01, 0.99), levels=yn)
steatosis <-  cptable(~steatosis | fatty_acid_beta_oxidation,
values=c(0.01, 0.99, 0.99, 0.01), levels=yn)
lrh1 <- cptable(~lrh1 | shp,
values=c(0.05, 0.95, 0.95, 0.05), levels=yn)
pi3k <- cptable(~pi3k, values=c(0.50, 0.50), levels=yn)
mtorc2 <- cptable(~mtorc2 | ir, values=c(0.99, 0.01, 0.01, 0.99), levels=yn)
ir <- cptable(~ir, values=c(0.50, 0.50), levels=yn)
akt <- cptable(~akt | pi3k+mtorc2, values=c(0.95, 0.05, 0.05, 0.95,
0.95, 0.05, 0.05, 0.95),
levels=yn)
lfabp <- cptable(~lfabp | akt+pi3k, values=c(0.95, 0.05, 0.05, 0.05, 0.50, 0.50, 0.05, 0.95),
levels=yn)
pparg <- cptable(~pparg | lfabp, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
fas <- cptable(~fas | lrh1+lxr+pparg, values=c(0.95, 0.05, 0.75, 0.25, 0.75, 0.25, 0.50, 0.50,
0.75, 0.25, 0.50, 0.50, 0.50, 0.50, 0.01, 0.99),
levels=yn)
mtorc1 <- cptable(~mtorc1 | akt, values=c(0.95, 0.05, 0.05, 0.95), levels=yn)
apkc <- cptable(~apkc | pi3k, values=c(0.99, 0.01, 0.01, 0.99), levels=yn)
srebp1 <- cptable(~srebp1 | mtorc1 + apkc, values=c(0.95, 0.05, 0.05, 0.95,
0.95, 0.05, 0.05, 0.95),
levels=yn)
scd1 <- cptable(~scd1 | srebp1, values=c(1, 0, 0, 1), levels=yn)
lipogenesis <- cptable(~lipogenesis | scd1 + fas, values=c(0.95, 0.05, 0.05, 0.95,
0.95, 0.05, 0.05, 0.95),
levels=yn)
cytosolic_fatty_acids <- cptable(~cytosolic_fatty_acids | lipogenesis + lfabp + fatty_acid_beta_oxidation,
values=c(0.01, 0.99, 0.01, 0.99, 0.01, 0.99, 0.01, 0.99,
0.99, 0.01, 0.66, 0.34, 0.66, 0.34, 0.50, 0.50),
levels=yn)
plist <- compileCPT(list(nrf2, fxr, shp, lxr, ppar_alpha, hsd17b4,
fatty_acid_beta_oxidation, steatosis, lrh1, pi3k,
mtorc2, ir, akt, lfabp, pparg, fas, mtorc1, apkc, srebp1, scd1, lipogenesis,
cytosolic_fatty_acids))
bn_test <- grain(plist)
plot(bn_test)
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no")) )
querygrain(setEvidence(bn_test, evidence=list(nrf2="no")) )
querygrain(setEvidence(bn_test, evidence=list(hsd17b4="no")))
querygrain(setEvidence(bn_test, evidence=list(nrf2="no")))
